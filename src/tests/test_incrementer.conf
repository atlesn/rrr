[instance_test_module]
module=test_module
test_method=test_anything
test_output_instance=instance_buffer_output

[instance_buffer_output]
module=buffer
senders=instance_perl5_server
topic_filter=rrr/success

[instance_msgdb]
module=msgdb
msgdb_directory=/tmp/rrr-test-msgdb
msgdb_socket=/tmp/rrr-test-msgdb.sock

[instance_perl5_generator]
module=perl5
senders=instance_httpclient
duplicate=yes
perl5_file=test_incrementer_generator.pl
perl5_source_sub=source
perl5_process_sub=process
perl5_source_interval_ms=100

[instance_incrementer]
module=incrementer
senders=instance_perl5_generator,instance_httpclient
duplicate=yes
#incrementer_msgdb_socket=/tmp/rrr-test-msgdb.sock
incrementer_subject_topic_filter=rrr/increment/+
#incrementer_id_topic=rrr/get-ids

[instance_httpclient]
module=httpclient
senders=instance_incrementer
duplicate=yes
http_server=localhost
http_port=8000
http_endpoint_from_topic=yes
http_receive_json_data=yes

#####

[instance_httpserver]
module=httpserver
senders=instance_perl5_server
duplicate=yes
http_server_port_plain=8000
http_server_allow_empty_messages=yes
http_server_get_response_from_senders=yes

[instance_perl5_server]
module=perl5
senders=instance_httpserver
duplicate=yes
buffer=no
perl5_file=test_incrementer_server.pl
perl5_source_sub=source
perl5_process_sub=process
perl5_source_interval_ms=500

[instance_mangler]
module=mangler
senders=instance_perl5_generator,instance_incrementer,instance_httpclient,instance_httpserver,instance_perl5_server
mangler_conversions=blob2str

[instance_drain]
module=raw
senders=instance_mangler
raw_print_data=yes
